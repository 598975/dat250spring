var Qe=Object.defineProperty;var Ge=(e,t,n)=>t in e?Qe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var fe=(e,t,n)=>Ge(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function x(){}function Ke(e){return!!e&&(typeof e=="object"||typeof e=="function")&&typeof e.then=="function"}function Re(e){return e()}function De(){return Object.create(null)}function te(e){e.forEach(Re)}function Fe(e){return typeof e=="function"}function He(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function We(e){return Object.keys(e).length===0}function r(e,t){e.appendChild(t)}function q(e,t,n){e.insertBefore(t,n||null)}function j(e){e.parentNode&&e.parentNode.removeChild(e)}function ge(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function c(e){return document.createElement(e)}function B(e){return document.createTextNode(e)}function b(){return B(" ")}function Xe(){return B("")}function L(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function _(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Ye(e){return Array.from(e.childNodes)}function G(e,t){t=""+t,e.data!==t&&(e.data=t)}function z(e,t){e.value=t??""}let oe;function R(e){oe=e}function Ze(){if(!oe)throw new Error("Function called outside component initialization");return oe}const Y=[],$e=[];let Z=[];const Ne=[],xe=Promise.resolve();let he=!1;function et(){he||(he=!0,xe.then(_e))}function me(e){Z.push(e)}const pe=new Set;let X=0;function _e(){if(X!==0)return;const e=oe;do{try{for(;X<Y.length;){const t=Y[X];X++,R(t),tt(t.$$)}}catch(t){throw Y.length=0,X=0,t}for(R(null),Y.length=0,X=0;$e.length;)$e.pop()();for(let t=0;t<Z.length;t+=1){const n=Z[t];pe.has(n)||(pe.add(n),n())}Z.length=0}while(Y.length);for(;Ne.length;)Ne.pop()();he=!1,pe.clear(),R(e)}function tt(e){if(e.fragment!==null){e.update(),te(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(me)}}function nt(e){const t=[],n=[];Z.forEach(l=>e.indexOf(l)===-1?t.push(l):n.push(l)),n.forEach(l=>l()),Z=t}const ce=new Set;let Q;function lt(){Q={r:0,c:[],p:Q}}function ot(){Q.r||te(Q.c),Q=Q.p}function Me(e,t){e&&e.i&&(ce.delete(e),e.i(t))}function it(e,t,n,l){if(e&&e.o){if(ce.has(e))return;ce.add(e),Q.c.push(()=>{ce.delete(e),l&&(e.d(1),l())}),e.o(t)}else l&&l()}function Le(e,t){const n=t.token={};function l(o,s,i,a){if(t.token!==n)return;t.resolved=a;let h=t.ctx;i!==void 0&&(h=h.slice(),h[i]=a);const d=o&&(t.current=o)(h);let O=!1;t.block&&(t.blocks?t.blocks.forEach((p,k)=>{k!==s&&p&&(lt(),it(p,1,1,()=>{t.blocks[k]===p&&(t.blocks[k]=null)}),ot())}):t.block.d(1),d.c(),Me(d,1),d.m(t.mount(),t.anchor),O=!0),t.block=d,t.blocks&&(t.blocks[s]=d),O&&_e()}if(Ke(e)){const o=Ze();if(e.then(s=>{R(o),l(t.then,1,t.value,s),R(null)},s=>{if(R(o),l(t.catch,2,t.error,s),R(null),!t.hasCatch)throw s}),t.current!==t.pending)return l(t.pending,0),!0}else{if(t.current!==t.then)return l(t.then,1,t.value,e),!0;t.resolved=e}}function rt(e,t,n){const l=t.slice(),{resolved:o}=e;e.current===e.then&&(l[e.value]=o),e.current===e.catch&&(l[e.error]=o),e.block.p(l,n)}function ee(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function ut(e,t,n){const{fragment:l,after_update:o}=e.$$;l&&l.m(t,n),me(()=>{const s=e.$$.on_mount.map(Re).filter(Fe);e.$$.on_destroy?e.$$.on_destroy.push(...s):te(s),e.$$.on_mount=[]}),o.forEach(me)}function st(e,t){const n=e.$$;n.fragment!==null&&(nt(n.after_update),te(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ct(e,t){e.$$.dirty[0]===-1&&(Y.push(e),et(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function at(e,t,n,l,o,s,i=null,a=[-1]){const h=oe;R(e);const d=e.$$={fragment:null,ctx:[],props:s,update:x,not_equal:o,bound:De(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(h?h.$$.context:[])),callbacks:De(),dirty:a,skip_bound:!1,root:t.target||h.$$.root};i&&i(d.root);let O=!1;if(d.ctx=n?n(e,t.props||{},(p,k,...A)=>{const y=A.length?A[0]:k;return d.ctx&&o(d.ctx[p],d.ctx[p]=y)&&(!d.skip_bound&&d.bound[p]&&d.bound[p](y),O&&ct(e,p)),k}):[],d.update(),O=!0,te(d.before_update),d.fragment=l?l(d.ctx):!1,t.target){if(t.hydrate){const p=Ye(t.target);d.fragment&&d.fragment.l(p),p.forEach(j)}else d.fragment&&d.fragment.c();t.intro&&Me(e.$$.fragment),ut(e,t.target,t.anchor),_e()}R(h)}class dt{constructor(){fe(this,"$$");fe(this,"$$set")}$destroy(){st(this,1),this.$destroy=x}$on(t,n){if(!Fe(n))return x;const l=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return l.push(n),()=>{const o=l.indexOf(n);o!==-1&&l.splice(o,1)}}$set(t){this.$$set&&!We(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const ft="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ft);function Ie(e,t,n){const l=e.slice();return l[20]=t[n],l}function Te(e,t,n){const l=e.slice();return l[23]=t[n],l}function Ue(e,t,n){const l=e.slice();return l[27]=t[n],l[28]=t,l[29]=n,l}function ze(e){let t,n,l,o;function s(){e[16].call(t,e[29])}return{c(){t=c("input"),n=c("br"),_(t,"type","text"),t.required=!0},m(i,a){q(i,t,a),z(t,e[4][e[29]]),q(i,n,a),l||(o=L(t,"input",s),l=!0)},p(i,a){e=i,a&16&&t.value!==e[4][e[29]]&&z(t,e[4][e[29]])},d(i){i&&(j(t),j(n)),l=!1,o()}}}function pt(e){let t=e[26]+"",n;return{c(){n=B(t)},m(l,o){q(l,n,o)},p(l,o){o&32&&t!==(t=l[26]+"")&&G(n,t)},d(l){l&&j(n)}}}function ht(e){let t,n=ee(Object.values(e[19])),l=[];for(let o=0;o<n.length;o+=1)l[o]=Je(Ie(e,n,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();t=Xe()},m(o,s){for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(o,s);q(o,t,s)},p(o,s){if(s&4128){n=ee(Object.values(o[19]));let i;for(i=0;i<n.length;i+=1){const a=Ie(o,n,i);l[i]?l[i].p(a,s):(l[i]=Je(a),l[i].c(),l[i].m(t.parentNode,t))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(o){o&&j(t),ge(l,o)}}}function Ve(e){let t,n=e[23].caption+"",l,o,s=e[20].votes.filter(A).length+"",i,a,h,d,O,p,k;function A(...y){return e[18](e[23],...y)}return{c(){t=c("li"),l=B(n),o=B(", votes: "),i=B(s),a=b(),h=c("button"),d=B("Vote"),_(h,"id",O=e[20].id+","+e[23].presentationOrder+","+e[23].caption)},m(y,S){q(y,t,S),r(t,l),r(t,o),r(t,i),q(y,a,S),q(y,h,S),r(h,d),p||(k=L(h,"click",e[12]),p=!0)},p(y,S){e=y,S&32&&n!==(n=e[23].caption+"")&&G(l,n),S&32&&s!==(s=e[20].votes.filter(A).length+"")&&G(i,s),S&32&&O!==(O=e[20].id+","+e[23].presentationOrder+","+e[23].caption)&&_(h,"id",O)},d(y){y&&(j(t),j(a),j(h)),p=!1,k()}}}function Je(e){let t,n,l=e[20].question+"",o,s,i,a,h,d,O=e[20].publishedAt+"",p,k,A,y,S=e[20].validUntil+"",V,$,D=ee(e[20].options),w=[];for(let m=0;m<D.length;m+=1)w[m]=Ve(Te(e,D,m));return{c(){t=c("div"),n=c("h2"),o=B(l),s=b(),i=c("ul");for(let m=0;m<w.length;m+=1)w[m].c();a=b(),h=c("p"),d=B("Published at: "),p=B(O),k=b(),A=c("p"),y=B("Valid until: "),V=B(S),$=b()},m(m,I){q(m,t,I),r(t,n),r(n,o),r(t,s),r(t,i);for(let u=0;u<w.length;u+=1)w[u]&&w[u].m(i,null);r(t,a),r(t,h),r(h,d),r(h,p),r(t,k),r(t,A),r(A,y),r(A,V),r(t,$)},p(m,I){if(I&32&&l!==(l=m[20].question+"")&&G(o,l),I&4128){D=ee(m[20].options);let u;for(u=0;u<D.length;u+=1){const g=Te(m,D,u);w[u]?w[u].p(g,I):(w[u]=Ve(g),w[u].c(),w[u].m(i,null))}for(;u<w.length;u+=1)w[u].d(1);w.length=D.length}I&32&&O!==(O=m[20].publishedAt+"")&&G(p,O),I&32&&S!==(S=m[20].validUntil+"")&&G(V,S)},d(m){m&&j(t),ge(w,m)}}}function mt(e){let t;return{c(){t=B("loading...")},m(n,l){q(n,t,l)},p:x,d(n){n&&j(t)}}}function gt(e){let t,n,l,o,s,i,a,h,d,O,p,k,A,y,S,V,$,D,w,m,I,u,g,f,T,U,F,be,J,ye,ve,ie,Oe,ne,we,le,Se,ke,K,Ce,Pe,re,je,M,qe,Ae,ue,ae,H,se,de,Ee,W=ee(e[4]),E=[];for(let v=0;v<W.length;v+=1)E[v]=ze(Ue(e,W,v));let N={ctx:e,current:null,token:null,hasCatch:!0,pending:mt,then:ht,catch:pt,value:19,error:26};return Le(se=e[5],N),{c(){t=c("div"),n=c("h1"),n.textContent="Login",l=b(),o=c("label"),o.textContent="Username",s=b(),i=c("input"),a=c("br"),h=b(),d=c("label"),d.textContent="Email",O=b(),p=c("input"),k=c("br"),A=b(),y=c("button"),y.textContent="Login",S=c("button"),S.textContent="Register",V=b(),$=c("div"),D=c("h1"),w=B("Logged in as "),m=B(e[2]),I=b(),u=c("button"),u.textContent="Log out",g=b(),f=c("div"),T=c("h1"),T.textContent="Create a poll",U=b(),F=c("label"),F.textContent="Question",be=b(),J=c("input"),ye=c("br"),ve=b(),ie=c("label"),ie.textContent="Options",Oe=b(),ne=c("div");for(let v=0;v<E.length;v+=1)E[v].c();we=b(),le=c("button"),le.textContent="Add option",Se=c("br"),ke=b(),K=c("button"),K.textContent="Remove option",Ce=c("br"),Pe=b(),re=c("label"),re.textContent="Deadline",je=b(),M=c("input"),qe=c("br"),Ae=b(),ue=c("button"),ue.textContent="Create",ae=b(),H=c("div"),N.block.c(),_(o,"for","username"),_(i,"type","text"),_(i,"id","username"),i.required=!0,_(d,"for","email"),_(p,"type","email"),_(p,"id","email"),p.required=!0,_(t,"class","login svelte-1jizjy0"),_($,"class","logout svelte-1jizjy0"),_(F,"for","question"),_(J,"type","text"),_(J,"id","question"),J.required=!0,_(ie,"for","options"),_(ne,"id","options"),_(le,"id","moreOptionsBtn"),_(K,"id","removeOptionsBtn"),K.disabled=!0,_(re,"for","deadline"),_(M,"type","datetime-local"),_(M,"id","deadline"),M.required=!0,_(f,"class","createPoll svelte-1jizjy0"),_(H,"class","displayPolls svelte-1jizjy0")},m(v,C){q(v,t,C),r(t,n),r(t,l),r(t,o),r(t,s),r(t,i),z(i,e[2]),r(t,a),r(t,h),r(t,d),r(t,O),r(t,p),z(p,e[3]),r(t,k),r(t,A),r(t,y),r(t,S),q(v,V,C),q(v,$,C),r($,D),r(D,w),r(D,m),r($,I),r($,u),q(v,g,C),q(v,f,C),r(f,T),r(f,U),r(f,F),r(f,be),r(f,J),z(J,e[0]),r(f,ye),r(f,ve),r(f,ie),r(f,Oe),r(f,ne);for(let P=0;P<E.length;P+=1)E[P]&&E[P].m(ne,null);r(f,we),r(f,le),r(f,Se),r(f,ke),r(f,K),r(f,Ce),r(f,Pe),r(f,re),r(f,je),r(f,M),z(M,e[1]),r(f,qe),r(f,Ae),r(f,ue),q(v,ae,C),q(v,H,C),N.block.m(H,N.anchor=null),N.mount=()=>H,N.anchor=null,de||(Ee=[L(i,"input",e[13]),L(p,"input",e[14]),L(y,"click",e[9]),L(S,"click",e[8]),L(u,"click",e[10]),L(J,"input",e[15]),L(le,"click",e[6]),L(K,"click",e[7]),L(M,"input",e[17]),L(ue,"click",e[11])],de=!0)},p(v,[C]){if(e=v,C&4&&i.value!==e[2]&&z(i,e[2]),C&8&&p.value!==e[3]&&z(p,e[3]),C&4&&G(m,e[2]),C&1&&J.value!==e[0]&&z(J,e[0]),C&16){W=ee(e[4]);let P;for(P=0;P<W.length;P+=1){const Be=Ue(e,W,P);E[P]?E[P].p(Be,C):(E[P]=ze(Be),E[P].c(),E[P].m(ne,null))}for(;P<E.length;P+=1)E[P].d(1);E.length=W.length}C&2&&z(M,e[1]),N.ctx=e,C&32&&se!==(se=e[5])&&Le(se,N)||rt(N,e,C)},i:x,o:x,d(v){v&&(j(t),j(V),j($),j(g),j(f),j(ae),j(H)),ge(E,v),N.block.d(),N.token=null,N=null,de=!1,te(Ee)}}}function _t(e,t,n){let l,o,s,i,a=["",""],h=fetch("/pollapp/polls").then(u=>u.status===200?u.json():"No polls found");function d(){let u=document.getElementById("removeOptionsBtn"),g=document.getElementById("moreOptionsBtn");a.length<5&&n(4,a=[...a,""]),a.length===5&&(g.disabled=!0),u.disabled=!1}function O(){let u=document.getElementById("removeOptionsBtn"),g=document.getElementById("moreOptionsBtn");a.length>2&&(n(4,a=a.slice(0,-1)),g.disabled=!1),a.length===2&&(u.disabled=!0)}function p(){fetch("/pollapp/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,email:i})}).then(u=>{if(u.status===201){alert("User created");let g=document.querySelector(".login"),f=document.querySelector(".createPoll"),T=document.querySelector(".logout"),U=document.querySelector(".displayPolls");g.setAttribute("style","display: none"),f.setAttribute("style","display: flex"),T.setAttribute("style","display: flex"),U.setAttribute("style","display: flex")}else alert("Something went wrong")}).catch(u=>{alert(u.message)})}async function k(){try{const u=await fetch("/pollapp/user/"+s,{method:"GET",headers:{"Content-Type":"application/json"}});if(u.status===200)if((await u.json()).email===i){let f=document.querySelector(".login"),T=document.querySelector(".createPoll"),U=document.querySelector(".logout"),F=document.querySelector(".displayPolls");f.setAttribute("style","display: none"),T.setAttribute("style","display: flex"),U.setAttribute("style","display: flex"),F.setAttribute("style","display: flex")}else alert("User not found");else alert("User not found")}catch(u){alert(u.message)}}function A(){n(2,s=""),n(3,i="");let u=document.querySelector(".login"),g=document.querySelector(".createPoll"),f=document.querySelector(".logout"),T=document.querySelector(".displayPolls");u.setAttribute("style","display: flex"),g.setAttribute("style","display: none"),f.setAttribute("style","display: none"),T.setAttribute("style","display: none")}function y(){fetch("/pollapp/polls",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:l,validUntil:new Date(o).toISOString(),options:a.map((u,g)=>({caption:u,presentationOrder:g})),pollCreator:{username:s,email:i}})}).then(u=>{u.status===201?(alert("Poll created"),n(0,l=""),n(1,o=""),n(4,a=["",""]),n(5,h=fetch("/pollapp/polls").then(g=>g.json()))):alert("Something went wrong")}).catch(u=>{alert(u.message)})}function S(u){let g=u.target.id.split(",")[0],f=u.target.id.split(",")[1],T=u.target.id.split(",")[2];fetch("/pollapp/votes/"+s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({option:{presentationOrder:f,caption:T},voter:{username:s,email:i},pollId:g})}).then(U=>{U.status===200?(alert("Vote registered"),n(5,h=fetch("/pollapp/polls").then(F=>F.json()))):alert("Something went wrong")}).catch(U=>{alert(U.message)})}function V(){s=this.value,n(2,s)}function $(){i=this.value,n(3,i)}function D(){l=this.value,n(0,l)}function w(u){a[u]=this.value,n(4,a)}function m(){o=this.value,n(1,o)}return[l,o,s,i,a,h,d,O,p,k,A,y,S,V,$,D,w,m,(u,g)=>g.option.presentationOrder===u.presentationOrder]}class bt extends dt{constructor(t){super(),at(this,t,_t,gt,He,{})}}new bt({target:document.getElementById("app")});
